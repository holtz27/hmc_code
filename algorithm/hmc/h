// energy function H
double H_hmc(const vec theta, const vec p, const List param, const mat inv_M, 
             num_ptr fun){
  
  // Energy function E = U + K, where U is the potencial energy and 
  // K the cinetic energy
  double E;
  
  // Evaluating K factor
  E = 0.5 * dot(p, inv_M * p);
  // Evaluating U factor
  E -= fun(theta, param);
  
  return E;
}
